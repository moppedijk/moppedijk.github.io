/*! webapp 2014-10-29 */
var FedApp=FedApp||{};FedApp.Components=FedApp.Components||{},FedApp.Models=FedApp.Models||{},FedApp.Views=FedApp.Views||{},function(){FedApp.App={init:function(){console.log("Initialize App"),FedApp.Config={appId:"fed-app"},this.startApp()},startApp:function(){FedApp.Router.init()}}}(),function(){FedApp.Router={currentView:!1,init:function(){{var a={"":function(){console.log("empty"),FedApp.Components.Loader.show(),setTimeout(function(){FedApp.Router.showMain()},300)},"/home":function(){console.log("/home"),FedApp.Components.Loader.show(),setTimeout(function(){FedApp.Router.showMain()},300)},"/about":function(){console.log("/about"),FedApp.Components.Loader.show(),setTimeout(function(){FedApp.Router.showAbout()},300)},"/main":{"/:type":{on:function(a){console.log("main/"+a),FedApp.Components.Loader.show(),setTimeout(function(){FedApp.Router.showList({type:a,locality:!1})},300)}}},"/main/:type/search":{"/:search":{on:function(a,b){console.log("/main/"+a+"/search/"+b),FedApp.Components.Loader.show(),setTimeout(function(){FedApp.Router.showList({type:a,locality:b})},300)}}},"/main/:type/detail":{"/:cidn":{on:function(a,b){console.log("/main/:"+a+"/detail/"+b),FedApp.Components.Loader.show(),setTimeout(function(){FedApp.Router.showDetail({type:a,cidn:b})},300)}}},"/*":function(){FedApp.Components.Loader.show(),FedApp.Router.showPage404()}};Router(a).init()}},showMain:function(){console.log("show main");var a=new FedApp.Views.Main;FedApp.Router.showView(a),FedApp.Router.showMenuState("home")},showList:function(a){console.log("show list");var b=new FedApp.Models.List;b.get({type:a.type,params:{page:1,per_page:100,locality:a.locality,after:"2014-10-22"}}),b.events.on("loadDataComplete",function(c){console.log(c);var d=new FedApp.Views.List(c);FedApp.Router.showView(d),FedApp.Router.showMenuState(a.type),b.events.off("loadDataComplete")})},showDetail:function(a){console.log("show detail");var b=new FedApp.Models.SingleObject;b.get({type:a.type,cidn:a.cidn}),b.events.on("loadDataComplete",function(a){console.log(a);var c=new FedApp.Views.Detail(a);FedApp.Router.showView(c),b.events.off("loadDataComplete")})},showAbout:function(){console.log("show about");var a=new FedApp.Views.About;FedApp.Router.showView(a),FedApp.Router.showMenuState("about")},showPage404:function(){console.log("show Page404");var a=new FedApp.Views.Page404;console.log(a),a.events.on("load404Complete",function(a){FedApp.Router.showView(a)})},showView:function(a){console.log("show View"),FedApp.Router.currentView=a;var b=document.getElementById(FedApp.Config.appId);b.innerHTML=FedApp.Router.currentView.render(),FedApp.Router.currentView.afterRender&&FedApp.Router.currentView.afterRender(),FedApp.Components.Loader.hide()},showMenuState:function(a){var b=document.getElementById("global-nav"),c=new Array("global-nav--home","global-nav--about"),d=document.getElementById("main-nav"),e=new Array("main__nav--event","main__nav--venue","main__nav--production");switch(a){case"home":FedApp.Router.setMenuState({items:c,active:"global-nav--home",target:b});break;case"about":FedApp.Router.setMenuState({items:c,active:"global-nav--about",target:b});break;case"event":FedApp.Router.setMenuState({items:e,active:"main__nav--event",target:d}),FedApp.Router.setMenuState({items:c,active:!1,target:b});break;case"venue":FedApp.Router.setMenuState({items:e,active:"main__nav--venue",target:d}),FedApp.Router.setMenuState({items:c,active:!1,target:b});break;case"production":FedApp.Router.setMenuState({items:e,active:"main__nav--production",target:d}),FedApp.Router.setMenuState({items:c,active:!1,target:b})}},setMenuState:function(a){for(var b=0;b<a.items.length;b++)a.target.hasClass(a.items[b])&&a.target.removeClass(a.items[b]),a.active&&a.target.addClass(a.active)}}}(),function(){FedApp.Components.Filter={removeHtml:function(a){if(a){var b=JSON.stringify(a),c=b.replace(/&(lt|gt);/g,function(a,b){return"lt"==b?"<":">"}),d=c.replace(/<\/?[^>]+(>|$)/g,"");b=d}return b},trimString:function(a,b){var c=a,d="";return d=c.length>b?c.substring(0,b):c},createStringFromObject:function(){return string}}}(),function(){FedApp.Components.Loader={loading:!1,show:function(){var a=document.getElementById("loader");a.hasClass("loader--inactive")&&(a.addClass("loader--isactive"),a.removeClass("loader--inactive"))},hide:function(){var a=document.getElementById("loader");a.hasClass("loader--isactive")&&(a.addClass("loader--inactive"),a.removeClass("loader--isactive"))}}}(),function(){var a=function(){this.path="http://api.artsholland.com/rest",this.events=new Events,this.init=function(){console.log("Initialize List model")},this.get=function(a){var b=this,c=a.type;a.params.locality||(a.params.locality="amsterdam");var d=a.params,e=this.path+"/"+c+".json";JSONP({url:e,data:d,success:function(a){b.filterList({type:c,data:a})},error:this.onErrorHandler})},this.filterList=function(a){for(var b=a.data,c=FedApp.Components.Filter,d=0;d<b.results.length;d++){var e=b.results[d];if(e.listType=a.type,e.attachment||(e.attachment=!1),e.created){var f=c.trimString(e.created,10);e.created=f}else e.created="No date";if(e.description||(e.description="No description"),e.eventStatus||(e.eventStatus=!1),e.genre||(e.genre=!1),e.hasBeginning||(e.hasBeginning=!1),e.hasEnd||(e.hasEnd=!1),e.homepage||(e.homepage=!1),e.languageNoProblem||(e.languageNoProblem=!1),e.modified||(e.modified=!1),e.offers||(e.offers=!1),e.production||(e.production=!1),e.productionType||(e.productionType=!1),e.shortDescription){var g=c.removeHtml(e.shortDescription),h=c.trimString(g,75);e.shortDescription=h}else{var g=c.removeHtml(e.description),h=c.trimString(g,75);e.shortDescription=h}e.sameAs||(e.sameAs=!1),e.title||(e.title="Untitled"),e.type||(e.type=!1),e.uri||(e.uri=!1),e.venue||(e.venue=!1),e.venueType||(e.venueType=!1)}b.metadata.listType=a.type,this.events.emit("loadDataComplete",b)},this.onErrorHandler=function(a){alert("ERROR: "+a)},this.init()};FedApp.Models.List=a}(),function(){var a=function(a){this.path="http://api.artsholland.com/rest",this.events=new Events,this.type=!1,this.init=function(){console.log("Initialize SingelObject model")},this.get=function(a){console.log(a);var b=this,c=a.cidn.toLowerCase();this.type=a.type;var d=this.path+"/"+this.type+"/"+c+".json";JSONP({url:d,success:function(a){b.filterSingelObj(a)},error:this.onErrorHandler})},this.filterSingelObj=function(a){var b=a.results[0];if(console.log(b),b.created||(b.created="No data about creation"),b.description||(b.description="No description"),b.email||(b.email="No email"),b.homepage||(b.homepage="No homepage"),b.locationAddress||(b.locationAddress="No location address"),b.listType||(b.listType=this.type),b.modified){if(typeof b.modified==typeof[]){for(var c="",d=0;d<b.modified.length;d++)c+=", "+b.modified[d];b.modified=c.slice(2)}}else b.modified="No information about modification";b.sameAs||(b.sameAs="Noting same as"),b.shortDescription||(b.shortDescription="No short description"),b.telephone||(b.telephone="No telephone"),b.title||(b.title="Untitled"),b.type||(b.type="No type"),b.uri||(b.uri="No uri"),b.venueType||(b.venueType="No venue type"),this.events.emit("loadDataComplete",b)},this.onErrorHandler=function(a){alert("ERROR: "+a)},this.init(a)};FedApp.Models.SingleObject=a}(),function(){var a=function(a){this.template="template-about",this.model=!1,this.events=new Events,this.init=function(){console.log("Initalize About")},this.render=function(){var a=document.getElementById(this.template),b=a.innerHTML,c=Handlebars.compile(b);return c()},this.init(a)};FedApp.Views.About=a}(),function(){var a=function(a){this.template="template-detail",this.model=!1,this.events=new Events,this.init=function(a){console.log("Initialize Detail View"),this.model=a},this.render=function(){var a=document.getElementById(this.template),b=a.innerHTML,c=Handlebars.compile(b);return c(this.model)},this.afterRender=function(){console.log("afterRender")},this.dispose=function(){},this.init(a)};FedApp.Views.Detail=a}(),function(){var a=function(a){this.template="template-main",this.subTemplate="template-list",this.model=!1,this.events=new Events,this.init=function(a){console.log("Initialize List view"),this.model=a},this.render=function(){var a=document.getElementById(this.template),b=a.innerHTML,c=Handlebars.compile(b);return c(this.model)},this.afterRender=function(){var a=document.getElementById(this.subTemplate),b=a.innerHTML,c=Handlebars.compile(b),d=document.getElementById("main-content");d.innerHTML=c(this.model)},this.dispose=function(){},this.onClickHandler=function(){var a=document.getElementById("form-input-locality");console.log(window),alert(a?"Zoek: "+a.value:"Graag een stad invullen")},this.onKeyPressHandler=function(b){if(13==b.keyCode){console.log(a);var c="event",d=b.target.value;routie("main/"+c+"/"+d)}},this.init(a)};FedApp.Views.List=a}(),function(){var a=function(a){this.template="template-main",this.subTemplate="template-home",this.model=!1,this.events=new Events,this.init=function(){console.log("Initialize main")},this.render=function(){var a=document.getElementById(this.template),b=a.innerHTML,c=Handlebars.compile(b);return c()},this.afterRender=function(){var a=document.getElementById(this.subTemplate),b=a.innerHTML,c=Handlebars.compile(b),d=document.getElementById("main-content");d.innerHTML=c()},this.init(a)};FedApp.Views.Main=a}(),function(){var a=function(a){this.template="template-404",this.events=new Events,this.init=function(){this.render()},this.render=function(){var a=document.getElementById(this.template),b=a.innerHTML,c=Handlebars.compile(b);return c()},this.init(a)};FedApp.Views.Page404=a}();